# OrigamiPost æŠ˜ã‚Šç´™æŠ˜ã‚Šå‹•ä½œå®Ÿè£…æ–¹é‡

## æ¦‚è¦

Three.js ã‚’ä½¿ç”¨ã—ã¦æŠ˜ã‚Šç´™ã®æŠ˜ã‚Šå‹•ä½œã‚’å†ç¾ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œã‹ã‚‰æŠ˜ã‚Šç·šã®è¨ˆç®—ã€å®Ÿéš›ã®æŠ˜ã‚Šå‹•ä½œã¾ã§ã‚’æ®µéšçš„ã«å®Ÿè£…ã™ã‚‹ã€‚

## ç¾åœ¨ã®é€²æ—çŠ¶æ³

| ã‚¹ãƒ†ãƒƒãƒ— | æ©Ÿèƒ½                                                      | çŠ¶æ…‹            |
| -------- | --------------------------------------------------------- | --------------- |
| 1        | ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ“ä½œ                                     | âœ… å®Œäº†         |
| 2-1      | æŠ˜ã‚Šç·šã®åŸºç¤è¨ˆç®— (`calculateFoldLine`)                    | âœ… å®Œäº†         |
| 2-2      | æŠ˜ã‚Šç·šã¨å¢ƒç•Œã®äº¤ç‚¹è¨ˆç®— (`calculateFoldLineIntersections`) | âœ… å®Œäº†         |
| 2-3      | æŠ˜ã‚Šç·šã®å¯è¦–åŒ– (`visualizeFoldLine`)                      | âœ… å®Œäº†         |
| 2-4      | useDropHandler ã¸ã®çµ±åˆ                                   | âœ… å®Œäº†         |
| 3        | æŠ˜ã‚Šç´™ã®æŠ˜ã‚Šå‹•ä½œ                                          | ğŸ”„ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ— |

## å®Ÿè£…æ‰‹é †

### 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ï¼‰

**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæŠ˜ã‚Šç´™ã®é ‚ç‚¹ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ã€æŠ˜ã‚ŠãŸã„æ–¹å‘ã‚’æŒ‡å®šã™ã‚‹

**å®Ÿè£…å†…å®¹**:

- Three.js ã® PlaneGeometry ã§ä½œæˆã—ãŸæ­£æ–¹å½¢ã®æ¿ï¼ˆæŠ˜ã‚Šç´™ï¼‰ã‚’è¡¨ç¤º âœ…
- å„é ‚ç‚¹ã«ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªãƒãƒ¼ã‚«ãƒ¼ï¼ˆèµ¤ã„ç‚¹ï¼‰ã‚’é…ç½® âœ…
- ãƒã‚¦ã‚¹/ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆã§ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œã‚’æ¤œçŸ¥ âœ…
- ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆé ‚ç‚¹ã®ç§»å‹•ï¼‰ âœ…

**ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³**:

- åŸºæœ¬çš„ãªãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½ã¯å®Ÿè£…æ¸ˆã¿ âœ…
- ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ç‚¹ã®ç§»å‹•ã¯æ­£å¸¸ã«å‹•ä½œ âœ…
- æŠ˜ã‚Šç·šè¨ˆç®—ã¸ã®æ©‹æ¸¡ã—å‡¦ç†ã‚’å®Ÿè£…äºˆå®š

**æŠ€è¡“çš„è©³ç´°**:

**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**:

- `useDragDrop`: ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½ã®çµ±åˆç®¡ç†
  - `useInitialRender`: æŠ˜ã‚Šç´™ã¨ã‚¹ãƒŠãƒƒãƒ—ãƒã‚¤ãƒ³ãƒˆã®åˆæœŸæç”»
  - `useDragHandler`: ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹ãƒ»ç§»å‹•å‡¦ç†
  - `useDropHandler`: ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†å‡¦ç†

**è²¬å‹™åˆ†æ‹…**:

1. **åˆæœŸæç”»ï¼ˆuseInitialRenderï¼‰**

   - æŠ˜ã‚Šç´™ã®æ¿ï¼ˆPlaneGeometryï¼‰ã‚’ã‚·ãƒ¼ãƒ³ã«é…ç½®
   - 4 ã¤ã®é ‚ç‚¹ã«ã‚¹ãƒŠãƒƒãƒ—ãƒã‚¤ãƒ³ãƒˆï¼ˆé’ã„çƒä½“ï¼‰ã‚’é…ç½®
   - ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ç‚¹ã¯æç”»ã‹ã‚‰é™¤å¤–

2. **ãƒ‰ãƒ©ãƒƒã‚°å‡¦ç†ï¼ˆuseDragHandlerï¼‰**

   - ãƒã‚¦ã‚¹ãƒ€ã‚¦ãƒ³æ™‚ã«ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ã‚¿ãƒ¼ã§ã‚¹ãƒŠãƒƒãƒ—ãƒã‚¤ãƒ³ãƒˆã¨ã®äº¤å·®ã‚’æ¤œå‡º
   - ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹æ™‚ã«ç‚¹ã‚’èµ¤è‰²ã§è¡¨ç¤º
   - ãƒã‚¦ã‚¹ç§»å‹•æ™‚ã«åœ°é¢ã¨ã®äº¤å·®ã§ç‚¹ã®ä½ç½®ã‚’æ›´æ–°

3. **ãƒ‰ãƒ­ãƒƒãƒ—å‡¦ç†ï¼ˆuseDropHandlerï¼‰**
   - ãƒã‚¦ã‚¹ã‚¢ãƒƒãƒ—æ™‚ã«æŠ˜ã‚Šç·šã‚’è¨ˆç®—
   - `calculateFoldLine`ã§æŠ˜ã‚Šç·šã®åŸºç¤æƒ…å ±ã‚’å–å¾—
   - `calculateFoldLineIntersections`ã§å¢ƒç•Œã¨ã®äº¤ç‚¹ã‚’è¨ˆç®—
   - `visualizeFoldLine`ã§æŠ˜ã‚Šç·šã‚’å¯è¦–åŒ–
   - æŠ˜ã‚Šç·šæƒ…å ±ã‚’çŠ¶æ…‹ã¨ã—ã¦ä¿å­˜
   - ãƒ‰ãƒ©ãƒƒã‚°çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
   - ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ç‚¹ã‚’ã‚·ãƒ¼ãƒ³ã‹ã‚‰å‰Šé™¤

**çŠ¶æ…‹ç®¡ç†**:

- `draggedPoint`: ç¾åœ¨ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®é ‚ç‚¹ã®åº§æ¨™
- `isDragging`: ãƒ‰ãƒ©ãƒƒã‚°çŠ¶æ…‹ã®ãƒ•ãƒ©ã‚°
- `originalPoint`: ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹æ™‚ã®å…ƒã®ç‚¹ã®ä½ç½®
- `foldLineState`: è¨ˆç®—ã•ã‚ŒãŸæŠ˜ã‚Šç·šã®æƒ…å ±

### 2. æŠ˜ã‚Šç·šã®è¨ˆç®—

**ç›®çš„**: ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œã‹ã‚‰æŠ˜ã‚Šç·šã®ä½ç½®ã¨æ–¹å‘ã‚’æ•°å­¦çš„ã«è¨ˆç®—ã™ã‚‹

**å®Ÿè£…çŠ¶æ³**: âœ… å®Œäº†

**è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯**:

- æŠ˜ã‚Šç´™ã®é…ç½®: **XY å¹³é¢**ä¸Šï¼ˆZ=0ï¼‰
- ãƒ‰ãƒ©ãƒƒã‚°å‰ã®é ‚ç‚¹ä½ç½®: `P1(x1, y1, z1)`
- ãƒ‰ãƒ©ãƒƒã‚°å¾Œã®é ‚ç‚¹ä½ç½®: `P2(x2, y2, z2)`
- ä¸­ç‚¹: `M = (P1 + P2) / 2`
- ãƒ‰ãƒ©ãƒƒã‚°æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«: `V = P2 - P1`
- æŠ˜ã‚Šç´™ã®æ³•ç·šãƒ™ã‚¯ãƒˆãƒ«: `N = (0, 0, 1)` ï¼ˆZ è»¸æ–¹å‘ã€XY å¹³é¢ã®æ³•ç·šï¼‰
- æŠ˜ã‚Šç·šã®æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«: `L = V Ã— N`ï¼ˆå¤–ç©ï¼‰
- æŠ˜ã‚Šç·šã¯ç‚¹`M`ã‚’é€šã‚Šã€æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«`L`ã‚’æŒã¤ç›´ç·šã¨ã—ã¦å®šç¾©

**å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½** âœ…:

1. **åŸºç¤è¨ˆç®—é–¢æ•°**: `calculateFoldLine(p1, p2)`

   - å ´æ‰€: `utils/calculateFoldLine/index.ts`
   - å…¥åŠ›: ãƒ‰ãƒ©ãƒƒã‚°å‰å¾Œã® 2 ç‚¹ (`p1`, `p2`)
   - å‡ºåŠ›: `{ midpoint, direction }` ï¼ˆä¸­ç‚¹ã¨æŠ˜ã‚Šç·šã®æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«ï¼‰
   - Three.js ã®çµ„ã¿è¾¼ã¿ãƒ¡ã‚½ãƒƒãƒ‰æ´»ç”¨ã§åŠ¹ç‡çš„ã«è¨ˆç®—
   - ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹å¯¾å¿œ: åŒã˜ç‚¹ã®å ´åˆã¯`null`ã‚’è¿”ã™

2. **æŠ˜ã‚Šç·šã¨æŠ˜ã‚Šç´™å¢ƒç•Œã®äº¤ç‚¹è¨ˆç®—**: `calculateFoldLineIntersections`

   - å ´æ‰€: `utils/calculateFoldLineIntersections/index.ts`
   - å…¥åŠ›: æŠ˜ã‚Šç·šæƒ…å ± (`midpoint`, `direction`)ã€æŠ˜ã‚Šç´™ã®ã‚µã‚¤ã‚º (`size`)
   - å‡¦ç†:

   1. æŠ˜ã‚Šç´™ã® 4 è¾ºã‚’ç·šåˆ†ã¨ã—ã¦å®šç¾©ï¼ˆXY å¹³é¢ä¸Šã€Z=0ï¼‰
   2. æŠ˜ã‚Šç·šï¼ˆç„¡é™ç›´ç·šï¼‰ã¨å„è¾ºï¼ˆç·šåˆ†ï¼‰ã®äº¤ç‚¹ã‚’è¨ˆç®—
   3. é‡è¤‡ã™ã‚‹äº¤ç‚¹ã‚’é™¤å»ï¼ˆæŠ˜ã‚Šç·šãŒé ‚ç‚¹ã‚’é€šã‚‹å ´åˆï¼‰
   4. æŠ˜ã‚Šç´™ã®å¢ƒç•Œä¸Šã«å­˜åœ¨ã™ã‚‹ 2 ã¤ã®äº¤ç‚¹ã‚’æŠ½å‡º
   5. äº¤ç‚¹ãŒã¡ã‚‡ã†ã© 2 ç‚¹ã§ãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼

   - å‡ºåŠ›: æŠ˜ã‚Šç·šã®å§‹ç‚¹ãƒ»çµ‚ç‚¹ (`start`, `end`)

3. **æŠ˜ã‚Šç·šã®å¯è¦–åŒ–**: `visualizeFoldLine`
   - å ´æ‰€: `utils/visualizeFoldLine/index.ts`
   - å…¥åŠ›: ã‚·ãƒ¼ãƒ³ã€å§‹ç‚¹ã€çµ‚ç‚¹
   - å®Ÿè£…: å††æŸ±ã‚¸ã‚ªãƒ¡ãƒˆãƒªã§æŠ˜ã‚Šç·šã‚’æç”»
     - 2 ç‚¹é–“ã®è·é›¢ã‚’è¨ˆç®—ã—ã¦å††æŸ±ã®é«˜ã•ã‚’æ±ºå®š
     - ä¸­ç‚¹ã«é…ç½®ã—ã€startâ†’end ã®æ–¹å‘ã«å›è»¢
     - æ—¢å­˜ã®æŠ˜ã‚Šç·šãŒã‚ã‚Œã°è‡ªå‹•çš„ã«å‰Šé™¤
   - ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º: è‰²ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: èµ¤ï¼‰ã€åŠå¾„ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.5ï¼‰

**å®Ÿè£…ã®æµã‚Œ** âœ…:

```typescript
// useDropHandlerã§å®Ÿè£…æ¸ˆã¿
const handleMouseUp = () => {
  if (!isDragging || !draggedPointMesh || !originalPoint) return;

  // 1. ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†åœ°ç‚¹ã‚’å–å¾—
  const finalPoint = draggedPointMesh.position.clone();

  // 2. æŠ˜ã‚Šç·šã®åŸºç¤æƒ…å ±ã‚’è¨ˆç®—
  const foldLine = calculateFoldLine(originalPoint, finalPoint);
  if (!foldLine) {
    console.warn("Invalid fold line: start and end points are the same");
    return;
  }

  // 3. æŠ˜ã‚Šç´™å¢ƒç•Œã¨ã®äº¤ç‚¹ã‚’è¨ˆç®—
  const intersections = calculateFoldLineIntersections(
    foldLine.midpoint,
    foldLine.direction,
    size
  );

  // 4. æŠ˜ã‚Šç·šã‚’å¯è¦–åŒ–
  visualizeFoldLine(scene, intersections.start, intersections.end);

  // 5. æŠ˜ã‚Šç·šæƒ…å ±ã‚’çŠ¶æ…‹ã¨ã—ã¦ä¿å­˜
  setFoldLineState({
    midpoint: foldLine.midpoint,
    direction: foldLine.direction,
    start: intersections.start,
    end: intersections.end,
  });

  // 6. ãƒ‰ãƒ©ãƒƒã‚°çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
  // ...
};
```

**é‡è¦ãªå®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ**:

1. **åº§æ¨™ç³»ã®çµ±ä¸€**: æŠ˜ã‚Šç´™ã¯ XY å¹³é¢ä¸Šï¼ˆZ=0ï¼‰ã«é…ç½®
2. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: åŒã˜ç‚¹ã€äº¤ç‚¹ãŒ 2 ç‚¹ã§ãªã„å ´åˆã®å‡¦ç†
3. **é‡è¤‡é™¤å»**: æŠ˜ã‚Šç·šãŒé ‚ç‚¹ã‚’é€šã‚‹å ´åˆã®é‡è¤‡äº¤ç‚¹ã®é™¤å»
4. **å¯è¦–åŒ–**: å††æŸ±ã‚¸ã‚ªãƒ¡ãƒˆãƒªã§ç›´æ„Ÿçš„ã«æŠ˜ã‚Šç·šã‚’è¡¨ç¤º

### 3. æŠ˜ã‚Šç´™ã®æŠ˜ã‚Šå‹•ä½œ

**ç›®çš„**: è¨ˆç®—ã•ã‚ŒãŸæŠ˜ã‚Šç·šã«åŸºã¥ã„ã¦æŠ˜ã‚Šç´™ã‚’å®Ÿéš›ã«æŠ˜ã‚‹

**å®Ÿè£…çŠ¶æ³**: ğŸ”„ å®Ÿè£…äºˆå®š

**å®Ÿè£…æ–¹é‡**:

1. **æ¿ã®åˆ†å‰²**: æŠ˜ã‚Šç·šã§æŠ˜ã‚Šç´™ã‚’ 2 ã¤ã®éƒ¨åˆ†ã«åˆ†å‰²
2. **å›è»¢ã®è¨ˆç®—**: æŠ˜ã‚Šç·šã‚’è»¸ã¨ã—ã¦ä¸€æ–¹ã®éƒ¨åˆ†ã‚’å›è»¢
3. **è¦–è¦šçš„è¡¨ç¾**: æŠ˜ã‚‰ã‚ŒãŸçŠ¶æ…‹ã‚’ Three.js ã§å†ç¾

**æŠ€è¡“çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**:

1. **ã‚¸ã‚ªãƒ¡ãƒˆãƒªåˆ†å‰²**

   - æŠ˜ã‚Šç·šã«åŸºã¥ã„ã¦ PlaneGeometry ã‚’ 2 ã¤ã®éƒ¨åˆ†ã«åˆ†å‰²
   - å„éƒ¨åˆ†ã‚’ç‹¬ç«‹ã—ãŸ Mesh ã¨ã—ã¦ä½œæˆ

2. **å›è»¢å‡¦ç†**

   - æŠ˜ã‚Šç·šã‚’è»¸ã¨ã—ã¦ä¸€æ–¹ã®éƒ¨åˆ†ã‚’ 180 åº¦å›è»¢
   - Three.js ã®`rotateOnAxis`ã‚’ä½¿ç”¨

3. **ã‚·ãƒ¼ãƒ³æ›´æ–°**
   - å…ƒã®æŠ˜ã‚Šç´™ã‚’éè¡¨ç¤º
   - åˆ†å‰²ã•ã‚ŒãŸ 2 ã¤ã®éƒ¨åˆ†ã‚’è¡¨ç¤º

**å¿…è¦ãªãƒ•ãƒƒã‚¯**:

- `useOrigamiFolding`: æŠ˜ã‚Šç´™ã®æŠ˜ã‚Šå‹•ä½œã®ç®¡ç†
- `geometryUtils`: ã‚¸ã‚ªãƒ¡ãƒˆãƒªã®åˆ†å‰²å‡¦ç†

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

### ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

- `OrigamiPost`: æŠ˜ã‚Šç´™æŠ˜ã‚Šå‹•ä½œã®ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- Three.js ã®ã‚·ãƒ¼ãƒ³ç®¡ç†ã€ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã€çŠ¶æ…‹ç®¡ç†ã‚’æ‹…å½“

### ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ï¼ˆå®Ÿè£…çŠ¶æ³ï¼‰

**âœ… å®Ÿè£…æ¸ˆã¿**:

- `useDragDrop`: ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ“ä½œã®ç®¡ç†
  - `useInitialRender`: æŠ˜ã‚Šç´™ã¨ã‚¹ãƒŠãƒƒãƒ—ãƒã‚¤ãƒ³ãƒˆã®åˆæœŸæç”»
  - `useDragHandler`: ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹ãƒ»ç§»å‹•å‡¦ç†ï¼ˆ`originalPoint`ã®ä¿å­˜å«ã‚€ï¼‰
  - `useDropHandler`: ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†å‡¦ç†ï¼ˆæŠ˜ã‚Šç·šè¨ˆç®—ã¨å¯è¦–åŒ–ã‚’çµ±åˆï¼‰

**ğŸ”„ å®Ÿè£…äºˆå®š**:

- `useOrigamiFolding`: æŠ˜ã‚Šç´™ã®æŠ˜ã‚Šå‹•ä½œã®ç®¡ç†

### ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°

**âœ… å®Ÿè£…æ¸ˆã¿**:

- `calculateFoldLine`: 2 ç‚¹ã‹ã‚‰æŠ˜ã‚Šç·šæƒ…å ±ã‚’è¨ˆç®—

  - å ´æ‰€: `utils/calculateFoldLine/index.ts`
  - å…¥åŠ›: `p1`, `p2` (Vector3)
  - å‡ºåŠ›: `{ midpoint, direction }` (FoldLineInfo | null)
  - ç‰¹å¾´: XY å¹³é¢å¯¾å¿œã€ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹å‡¦ç†

- `calculateFoldLineIntersections`: æŠ˜ã‚Šç·šã¨æŠ˜ã‚Šç´™å¢ƒç•Œã®äº¤ç‚¹è¨ˆç®—

  - å ´æ‰€: `utils/calculateFoldLineIntersections/index.ts`
  - å…¥åŠ›: `midpoint`, `direction` (Vector3), `size` (number)
  - å‡ºåŠ›: `{ start, end }` (FoldLineIntersections)
  - ç‰¹å¾´: XY å¹³é¢å¯¾å¿œã€é‡è¤‡é™¤å»ã€å³å¯†ãª 2 ç‚¹æ¤œè¨¼

- `visualizeFoldLine`: æŠ˜ã‚Šç·šã®å¯è¦–åŒ–
  - å ´æ‰€: `utils/visualizeFoldLine/index.ts`
  - å…¥åŠ›: `scene` (Scene), `start`, `end` (Vector3)
  - ç‰¹å¾´: å††æŸ±ã‚¸ã‚ªãƒ¡ãƒˆãƒªã€è‡ªå‹•å‰Šé™¤ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½

**ğŸ”„ å®Ÿè£…äºˆå®š**:

- `geometryUtils`: ã‚¸ã‚ªãƒ¡ãƒˆãƒªã®åˆ†å‰²ã€å¤‰å½¢ã«é–¢ã™ã‚‹é–¢æ•°

## çŠ¶æ…‹ç®¡ç†

**å®Ÿè£…æ¸ˆã¿ã®çŠ¶æ…‹** âœ…:

```typescript
// ãƒ‰ãƒ©ãƒƒã‚°çŠ¶æ…‹
const [draggedPoint, setDraggedPoint] = useState<Point | null>(null);
const [isDragging, setIsDragging] = useState(false);

// ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹æ™‚ã®å…ƒã®ç‚¹ã®ä½ç½®
const [originalPoint, setOriginalPoint] = useState<THREE.Vector3 | null>(null);

// æŠ˜ã‚Šç·šçŠ¶æ…‹
interface FoldLineState {
  midpoint: THREE.Vector3; // æŠ˜ã‚Šç·šãŒé€šã‚‹ä¸­ç‚¹
  direction: THREE.Vector3; // æŠ˜ã‚Šç·šã®æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«
  start: THREE.Vector3; // æŠ˜ã‚Šç·šã®å§‹ç‚¹ï¼ˆæŠ˜ã‚Šç´™å¢ƒç•Œã¨ã®äº¤ç‚¹ï¼‰
  end: THREE.Vector3; // æŠ˜ã‚Šç·šã®çµ‚ç‚¹ï¼ˆæŠ˜ã‚Šç´™å¢ƒç•Œã¨ã®äº¤ç‚¹ï¼‰
}

const [foldLineState, setFoldLineState] = useState<FoldLineState | null>(null);
```

**å°†æ¥ã®æ‹¡å¼µäºˆå®š** ğŸ”„:

```typescript
// æŠ˜ã‚Šç´™ã®æŠ˜ã‚ŠçŠ¶æ…‹ï¼ˆæŠ˜ã‚Šå‹•ä½œå®Ÿè£…æ™‚ã«è¿½åŠ ï¼‰
interface FoldedState {
  isFolded: boolean;
  leftPart: THREE.Mesh | null;
  rightPart: THREE.Mesh | null;
  foldAngle: number;
}

const [foldedState, setFoldedState] = useState<FoldedState | null>(null);
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …

1. **ã‚¸ã‚ªãƒ¡ãƒˆãƒªã®æœ€é©åŒ–**: ä¸è¦ãªé ‚ç‚¹ã®å‰Šé™¤ã€LODï¼ˆLevel of Detailï¼‰ã®å®Ÿè£…
2. **ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã®æœ€é©åŒ–**: ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆç¶­æŒ
3. **ãƒ¡ãƒ¢ãƒªç®¡ç†**: ä¸è¦ãªã‚¸ã‚ªãƒ¡ãƒˆãƒªã‚„ãƒãƒ†ãƒªã‚¢ãƒ«ã®é©åˆ‡ãªç ´æ£„
4. **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³**: æŠ˜ã‚Šå‹•ä½œã®ã‚¹ãƒ ãƒ¼ã‚ºãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…

## ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

1. **è¤‡æ•°å›ã®æŠ˜ã‚Š**: ä¸€åº¦æŠ˜ã£ãŸæŠ˜ã‚Šç´™ã‚’ã•ã‚‰ã«æŠ˜ã‚‹æ©Ÿèƒ½
2. **æŠ˜ã‚Šç·šã®å¯è¦–åŒ–**: æŠ˜ã‚Šç·šã®è¡¨ç¤º/éè¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
3. **æŠ˜ã‚Šç´™ã®ãƒªã‚»ãƒƒãƒˆ**: åˆæœŸçŠ¶æ…‹ã¸ã®å¾©å¸°æ©Ÿèƒ½
4. **æŠ˜ã‚Šãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¿å­˜**: æŠ˜ã‚Šæ–¹ã®ä¿å­˜ãƒ»èª­ã¿è¾¼ã¿æ©Ÿèƒ½
5. **ç‰©ç†æ¼”ç®—**: ã‚ˆã‚Šç¾å®Ÿçš„ãªæŠ˜ã‚Šç´™ã®ç‰©ç†ç‰¹æ€§ã®å†ç¾
